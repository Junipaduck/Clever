<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.clever.mapper.GoodsMapper">

	<insert id="insertGoods">
		<selectKey keyProperty="goods_idx" resultType="int" order="BEFORE">
				SELECT IFNULL(MAX(goods_idx), 0) FROM goods
		</selectKey>
			INSERT
				INTO goods
				VALUES (
					#{goods_idx} + 1 -- 굿즈 번호
					, #{goods_name}
					, #{goods_price}
					, #{goods_content}
					, #{goods_file}
					, now()
				)
	</insert>
	
	<insert id="insertFile">
		<selectKey keyProperty="file_idx" resultType="int" order="BEFORE">
				SELECT IFNULL(MAX(file_idx), 0) FROM file
		</selectKey>
		INSERT
				INTO file (file_idx, file_div, file_num, file_name, file_path, file_size, file_exe)
				VALUES (
					#{file_idx} + 1,
					#{file_div},
					#{file_num},
					#{file_name},
					#{file_path},
					#{file_size},
					#{file_exe}
			)
	</insert>
	
	<select id="selectMax" resultType="int">
		SELECT
			MAX(goods_idx)
			FROM goods;
	</select>
	
</mapper>






















